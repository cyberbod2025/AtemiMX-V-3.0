import{r as i,k as le,M as oe,R as I,j as n,l as A,C as se,m as ie,e as ce}from"./index-CuykJsXK.js";import{r as X,c as de,a as ue,S as he,b as ge,u as me,s as fe,d as pe,e as ve,f as be,g as ye,h as xe,i as je,j as we,k as Y,l as Pe,m as B,n as Oe,R as k,C as z,T as D}from"./CategoricalChart-CQIJYn4j.js";import{P as L,a as K}from"./PieChart-C2RHgbG5.js";import{B as _,C as G,X as W,Y as M,a as U}from"./BarChart-BP6rETGf.js";function R(){return R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},R.apply(null,arguments)}function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,a)}return r}function Se(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H(Object(r),!0).forEach(function(a){Ne(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Ne(e,t,r){return(t=Ee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ee(e){var t=ke(e,"string");return typeof t=="symbol"?t:t+""}function ke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var y=32,De={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function Ce(e){var{data:t,iconType:r,inactiveColor:a}=e,o=y/2,c=y/6,b=y/3,h=t.inactive?a:t.color,p=r??t.type;if(p==="none")return null;if(p==="plainline"){var g;return i.createElement("line",{strokeWidth:4,fill:"none",stroke:h,strokeDasharray:(g=t.payload)===null||g===void 0?void 0:g.strokeDasharray,x1:0,y1:o,x2:y,y2:o,className:"recharts-legend-icon"})}if(p==="line")return i.createElement("path",{strokeWidth:4,fill:"none",stroke:h,d:"M0,".concat(o,"h").concat(b,`
            A`).concat(c,",").concat(c,",0,1,1,").concat(2*b,",").concat(o,`
            H`).concat(y,"M").concat(2*b,",").concat(o,`
            A`).concat(c,",").concat(c,",0,1,1,").concat(b,",").concat(o),className:"recharts-legend-icon"});if(p==="rect")return i.createElement("path",{stroke:"none",fill:h,d:"M0,".concat(y/8,"h").concat(y,"v").concat(y*3/4,"h").concat(-y,"z"),className:"recharts-legend-icon"});if(i.isValidElement(t.legendIcon)){var d=Se({},t);return delete d.legendIcon,i.cloneElement(t.legendIcon,d)}return i.createElement(ge,{fill:h,cx:o,cy:o,size:y,sizeType:"diameter",type:p})}function Re(e){var{payload:t,iconSize:r,layout:a,formatter:o,inactiveColor:c,iconType:b}=e,h={x:0,y:0,width:y,height:y},p={display:a==="horizontal"?"inline-block":"block",marginRight:10},g={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,m)=>{var j=d.formatter||o,v=de({"recharts-legend-item":!0,["legend-item-".concat(m)]:!0,inactive:d.inactive});if(d.type==="none")return null;var x=d.inactive?c:d.color,P=j?j(d.value,d,m):d.value;return i.createElement("li",R({className:v,style:p,key:"legend-item-".concat(m)},ue(e,d,m)),i.createElement(he,{width:r,height:r,viewBox:h,style:g,"aria-label":"".concat(P," legend icon")},i.createElement(Ce,{data:d,iconType:b,inactiveColor:c})),i.createElement("span",{className:"recharts-legend-item-text",style:{color:x}},P))})}var Fe=e=>{var t=X(e,De),{payload:r,layout:a,align:o}=t;if(!r||!r.length)return null;var c={padding:0,margin:0,textAlign:a==="horizontal"?o:"left"};return i.createElement("ul",{className:"recharts-default-legend",style:c},i.createElement(Re,R({},t,{payload:r})))};function Ie(){return me(fe)}var Te=["contextPayload"];function T(){return T=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},T.apply(null,arguments)}function $(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,a)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$(Object(r),!0).forEach(function(a){Ae(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Ae(e,t,r){return(t=Be(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Be(e){var t=ze(e,"string");return typeof t=="symbol"?t:t+""}function ze(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Le(e,t){if(e==null)return{};var r,a,o=Ke(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Ke(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function _e(e){return e.value}function Ge(e){var{contextPayload:t}=e,r=Le(e,Te),a=Oe(t,e.payloadUniqBy,_e),o=O(O({},r),{},{payload:a});return i.isValidElement(e.content)?i.cloneElement(e.content,o):typeof e.content=="function"?i.createElement(e.content,o):i.createElement(Fe,o)}function We(e,t,r,a,o,c){var{layout:b,align:h,verticalAlign:p}=t,g,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(h==="center"&&b==="vertical"?g={left:((a||0)-c.width)/2}:g=h==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(p==="middle"?d={top:((o||0)-c.height)/2}:d=p==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),O(O({},g),d)}function Me(e){var t=Y();return i.useEffect(()=>{t(Pe(e))},[t,e]),null}function Ue(e){var t=Y();return i.useEffect(()=>(t(B(e)),()=>{t(B({width:0,height:0}))}),[t,e]),null}function He(e,t,r,a){return e==="vertical"&&we(t)?{height:t}:e==="horizontal"?{width:r||a}:null}var $e={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function C(e){var t=X(e,$e),r=Ie(),a=pe(),o=ve(),{width:c,height:b,wrapperStyle:h,portal:p}=t,[g,d]=be([r]),m=ye(),j=xe();if(m==null||j==null)return null;var v=m-((o==null?void 0:o.left)||0)-((o==null?void 0:o.right)||0),x=He(t.layout,b,c,v),P=p?h:O(O({position:"absolute",width:(x==null?void 0:x.width)||c||"auto",height:(x==null?void 0:x.height)||b||"auto"},We(h,t,o,m,j,g)),h),l=p??a;if(l==null||r==null)return null;var f=i.createElement("div",{className:"recharts-legend-wrapper",style:P,ref:d},i.createElement(Me,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),i.createElement(Ue,{width:g.width,height:g.height}),i.createElement(Ge,T({},t,x,{margin:o,chartWidth:m,chartHeight:j,contextPayload:r})));return je.createPortal(f,l)}C.displayName="Legend";const V=["#0088FE","#00C49F","#FFBB28","#FF8042"],q=["#3B82F6","#F59E0B","#10B981"],Ze=({currentUser:e})=>{const[t,r]=i.useState([]),[a,o]=i.useState([]),[c,b]=i.useState("all"),[h,p]=i.useState("all"),[g,d]=i.useState("all"),m=oe,j=le.filter(l=>l.role==="teacher");i.useEffect(()=>{(async()=>{const f=await ce();r(f),o(f)})()},[]),i.useEffect(()=>{let l=t;c!=="all"&&(l=l.filter(f=>{var w;return((w=m.find(S=>S.id===f.studentId))==null?void 0:w.grade)===c})),h!=="all"&&(l=l.filter(f=>{var w;return((w=m.find(S=>S.id===f.studentId))==null?void 0:w.group)===h})),g!=="all"&&(l=l.filter(f=>f.studentId===g)),o(l)},[c,h,g,t,m]);const v=i.useMemo(()=>{const l=a.length,f=a.filter(s=>s.status===I.New).length,w=a.filter(s=>s.status===I.InProgress).length,S=a.filter(s=>s.status===I.Resolved).length,Z=a.reduce((s,u)=>(s[u.type]=(s[u.type]||0)+1,s),{}),J=Object.entries(Z).map(([s,u])=>({name:s,value:u})),Q=a.reduce((s,u)=>(s[u.status]=(s[u.status]||0)+1,s),{}),ee=Object.entries(Q).map(([s,u])=>({name:s,value:u})),te=a.reduce((s,u)=>{var E;const N=((E=j.find(F=>F.id===u.teacherId))==null?void 0:E.name)||"Desconocido";return s[N]=(s[N]||0)+1,s},{}),re=Object.entries(te).map(([s,u])=>({name:s,value:u})),ae=a.reduce((s,u)=>{var E;const N=((E=m.find(F=>F.id===u.studentId))==null?void 0:E.grade)||"N/A";return s[N]=(s[N]||0)+1,s},{}),ne=Object.entries(ae).map(([s,u])=>({name:s,value:u})).sort((s,u)=>s.name.localeCompare(u.name));return{total:l,newCount:f,inProgress:w,resolved:S,typeData:J,statusData:ee,teacherData:re,gradeData:ne}},[a,m,j]),x=[...new Set(m.map(l=>l.grade))],P=[...new Set(m.map(l=>l.group))];return n.jsxs("div",{className:"space-y-6",children:[n.jsx("h2",{className:"text-2xl font-bold flex items-center text-gray-800 dark:text-white",children:"Panel de Coordinación y Dirección"}),n.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-md flex flex-wrap items-center gap-4",children:[n.jsx("h3",{className:"font-semibold mr-2",children:"Filtros:"}),n.jsxs("select",{onChange:l=>b(l.target.value),value:c,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",children:[n.jsx("option",{value:"all",children:"Todos los Grados"}),x.map(l=>n.jsx("option",{value:l,children:l},l))]}),n.jsxs("select",{onChange:l=>p(l.target.value),value:h,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",children:[n.jsx("option",{value:"all",children:"Todos los Grupos"}),P.map(l=>n.jsx("option",{value:l,children:l},l))]}),n.jsxs("select",{onChange:l=>d(l.target.value),value:g,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",children:[n.jsx("option",{value:"all",children:"Todos los Alumnos"}),m.map(l=>n.jsx("option",{value:l.id,children:l.name},l.id))]})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[n.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow text-center",children:[n.jsx("h4",{className:"font-semibold",children:"Reportes Totales"}),n.jsx("p",{className:"text-3xl font-bold",children:v.total})]}),n.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow text-center",children:[n.jsx("h4",{className:"font-semibold",children:"Nuevos"}),n.jsx("p",{className:"text-3xl font-bold text-blue-500",children:v.newCount})]}),n.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow text-center",children:[n.jsx("h4",{className:"font-semibold",children:"En Progreso"}),n.jsx("p",{className:"text-3xl font-bold text-yellow-500",children:v.inProgress})]}),n.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow text-center",children:[n.jsx("h4",{className:"font-semibold",children:"Resueltos"}),n.jsx("p",{className:"text-3xl font-bold text-green-500",children:v.resolved})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow h-80",children:[n.jsxs("h4",{className:"font-semibold mb-2 text-center flex items-center justify-center",children:[n.jsx(A,{className:"h-5 w-5 mr-2"}),"Reportes por Tipo"]}),n.jsx(k,{width:"100%",height:"100%",children:n.jsxs(L,{children:[n.jsx(K,{data:v.typeData,dataKey:"value",nameKey:"name",cx:"50%",cy:"45%",outerRadius:80,fill:"#8884d8",label:!0,children:v.typeData.map((l,f)=>n.jsx(z,{fill:V[f%V.length]},`cell-${f}`))}),n.jsx(D,{}),n.jsx(C,{})]})})]}),n.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow h-80",children:[n.jsxs("h4",{className:"font-semibold mb-2 text-center flex items-center justify-center",children:[n.jsx(A,{className:"h-5 w-5 mr-2"}),"Reportes por Estado"]}),n.jsx(k,{width:"100%",height:"100%",children:n.jsxs(L,{children:[n.jsx(K,{data:v.statusData,dataKey:"value",nameKey:"name",cx:"50%",cy:"45%",outerRadius:80,fill:"#82ca9d",label:!0,children:v.statusData.map((l,f)=>n.jsx(z,{fill:q[f%q.length]},`cell-${f}`))}),n.jsx(D,{}),n.jsx(C,{})]})})]}),n.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow h-80 lg:col-span-2",children:[n.jsxs("h4",{className:"font-semibold mb-2 text-center flex items-center justify-center",children:[n.jsx(se,{className:"h-5 w-5 mr-2"}),"Incidencia por Docente"]}),n.jsx(k,{width:"100%",height:"90%",children:n.jsxs(_,{data:v.teacherData,layout:"vertical",margin:{top:5,right:30,left:50,bottom:5},children:[n.jsx(G,{strokeDasharray:"3 3"}),n.jsx(W,{type:"number"}),n.jsx(M,{type:"category",dataKey:"name",width:120}),n.jsx(D,{}),n.jsx(U,{dataKey:"value",fill:"#8884d8"})]})})]}),n.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow h-80 lg:col-span-2",children:[n.jsxs("h4",{className:"font-semibold mb-2 text-center flex items-center justify-center",children:[n.jsx(ie,{className:"h-5 w-5 mr-2"}),"Incidencia por Grado"]}),n.jsx(k,{width:"100%",height:"90%",children:n.jsxs(_,{data:v.gradeData,margin:{top:20,right:30,left:20,bottom:5},children:[n.jsx(G,{strokeDasharray:"3 3"}),n.jsx(W,{dataKey:"name"}),n.jsx(M,{}),n.jsx(D,{}),n.jsx(C,{}),n.jsx(U,{dataKey:"value",fill:"#82ca9d"})]})})]})]})]})};export{Ze as default};
