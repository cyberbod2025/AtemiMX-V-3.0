import{r as n,j as e,D as N,C as v,a as C,g as D}from"./index-J06LgYwp.js";import{R as k}from"./ReportForm-CftKmYLq.js";import{R as F}from"./ReportCard-BBi0SBXQ.js";import{R as g,C as u,T as j}from"./CategoricalChart-CVOWy7Az.js";import{P as y,a as b}from"./PieChart-W8hkL1fR.js";import"./geminiService-fkZN5fdV.js";const c=["#0088FE","#00C49F","#FFBB28","#FF8042"],K=({currentUser:l,viewStudentProfile:f})=>{const[i,m]=n.useState([]),[h,p]=n.useState(!1);n.useEffect(()=>{(async()=>{const s=await D(l.id);m(s.sort((d,x)=>new Date(x.date).getTime()-new Date(d.date).getTime()))})()},[l.id]);const R=t=>{m(s=>[t,...s]),p(!1)},w=t=>{m(s=>s.map(d=>d.id===t.id?t:d))},o=n.useMemo(()=>{const t=i.reduce((a,r)=>(a[r.type]=(a[r.type]||0)+1,a),{}),s=Object.entries(t).map(([a,r])=>({name:a,value:r})),d=i.reduce((a,r)=>(a[r.status]=(a[r.status]||0)+1,a),{}),x=Object.entries(d).map(([a,r])=>({name:a,value:r}));return{typeData:s,statusData:x}},[i]);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Mi Panel"}),e.jsxs("button",{onClick:()=>p(!h),className:"flex items-center bg-blue-600 text-white font-semibold px-4 py-2 rounded-lg shadow-md hover:bg-blue-700 transition-colors",children:[e.jsx(N,{className:"h-5 w-5 mr-2"}),h?"Cancelar Reporte":"Nuevo Reporte"]})]}),h&&e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg animate-fade-in-down",children:e.jsx(k,{currentUser:l,onReportSubmit:R})}),i.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold flex items-center mb-4 text-gray-700 dark:text-gray-300",children:[e.jsx(v,{className:"h-6 w-6 mr-2"}),"Mis Estadísticas"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-md h-64",children:[e.jsx("h4",{className:"font-semibold mb-2 text-center",children:"Mis Reportes por Tipo"}),e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(y,{children:[e.jsx(b,{data:o.typeData,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:40,outerRadius:60,fill:"#8884d8",paddingAngle:5,label:!0,children:o.typeData.map((t,s)=>e.jsx(u,{fill:c[s%c.length]},`cell-${s}`))}),e.jsx(j,{})]})})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-md h-64",children:[e.jsx("h4",{className:"font-semibold mb-2 text-center",children:"Mis Reportes por Estado"}),e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(y,{children:[e.jsx(b,{data:o.statusData,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:40,outerRadius:60,fill:"#82ca9d",paddingAngle:5,label:!0,children:o.statusData.map((t,s)=>e.jsx(u,{fill:c.slice(2)[s%c.length]},`cell-${s}`))}),e.jsx(j,{})]})})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold flex items-center mb-4 text-gray-700 dark:text-gray-300",children:[e.jsx(C,{className:"h-6 w-6 mr-2"}),"Historial de Reportes Enviados"]}),i.length>0?e.jsx("div",{className:"space-y-4",children:i.map(t=>e.jsx(F,{report:t,viewStudentProfile:f,onReportUpdate:w,currentUser:l},t.id))}):e.jsx("div",{className:"text-center py-10 px-6 bg-white dark:bg-gray-800 rounded-lg shadow-md",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No has enviado ningún reporte todavía."})})]})]})};export{K as default};
