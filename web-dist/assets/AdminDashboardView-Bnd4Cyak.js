import{r as n,j as e}from"./react-vendor-BfikQoQB.js";import{f as H,M as J,R as f,h as k,C as Q,i as W,b as Z}from"./AtemiDashboard-BNj4r2iA.js";import{R as p,P as R,c as C,C as D,T as b,L as y,B as S,d as F,X as T,Y as I,e as E}from"./vendor-CUhUAKZ9.js";import"./index-CGsLMNMp.js";import"./firebase-Bi_eiI5S.js";const K=["#0088FE","#00C49F","#FFBB28","#FF8042"],O=["#3B82F6","#F59E0B","#10B981"],de=({currentUser:ee})=>{const[w,B]=n.useState([]),[d,N]=n.useState([]),[x,G]=n.useState("all"),[m,P]=n.useState("all"),[u,A]=n.useState("all"),o=J,v=H.filter(s=>s.role==="teacher");n.useEffect(()=>{(async()=>{const r=await Z();B(r),N(r)})()},[]),n.useEffect(()=>{let s=w;x!=="all"&&(s=s.filter(r=>{var i;return((i=o.find(c=>c.id===r.studentId))==null?void 0:i.grade)===x})),m!=="all"&&(s=s.filter(r=>{var i;return((i=o.find(c=>c.id===r.studentId))==null?void 0:i.group)===m})),u!=="all"&&(s=s.filter(r=>r.studentId===u)),N(s)},[x,m,u,w,o]);const l=n.useMemo(()=>{const s=d.length,r=d.filter(t=>t.status===f.New).length,i=d.filter(t=>t.status===f.InProgress).length,c=d.filter(t=>t.status===f.Resolved).length,M=d.reduce((t,a)=>(t[a.type]=(t[a.type]||0)+1,t),{}),_=Object.entries(M).map(([t,a])=>({name:t,value:a})),X=d.reduce((t,a)=>(t[a.status]=(t[a.status]||0)+1,t),{}),Y=Object.entries(X).map(([t,a])=>({name:t,value:a})),$=d.reduce((t,a)=>{var g;const h=((g=v.find(j=>j.id===a.teacherId))==null?void 0:g.name)||"Desconocido";return t[h]=(t[h]||0)+1,t},{}),V=Object.entries($).map(([t,a])=>({name:t,value:a})),q=d.reduce((t,a)=>{var g;const h=((g=o.find(j=>j.id===a.studentId))==null?void 0:g.grade)||"N/A";return t[h]=(t[h]||0)+1,t},{}),z=Object.entries(q).map(([t,a])=>({name:t,value:a})).sort((t,a)=>t.name.localeCompare(a.name));return{total:s,newCount:r,inProgress:i,resolved:c,typeData:_,statusData:Y,teacherData:V,gradeData:z}},[d,o,v]),U=[...new Set(o.map(s=>s.grade))],L=[...new Set(o.map(s=>s.group))];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold flex items-center text-gray-800 dark:text-white",children:"Panel de Coordinación y Dirección"}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-md flex flex-wrap items-center gap-4",children:[e.jsx("h3",{className:"font-semibold mr-2",children:"Filtros:"}),e.jsxs("select",{onChange:s=>G(s.target.value),value:x,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",children:[e.jsx("option",{value:"all",children:"Todos los Grados"}),U.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("select",{onChange:s=>P(s.target.value),value:m,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",children:[e.jsx("option",{value:"all",children:"Todos los Grupos"}),L.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("select",{onChange:s=>A(s.target.value),value:u,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",children:[e.jsx("option",{value:"all",children:"Todos los Alumnos"}),o.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow text-center",children:[e.jsx("h4",{className:"font-semibold",children:"Reportes Totales"}),e.jsx("p",{className:"text-3xl font-bold",children:l.total})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow text-center",children:[e.jsx("h4",{className:"font-semibold",children:"Nuevos"}),e.jsx("p",{className:"text-3xl font-bold text-blue-500",children:l.newCount})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow text-center",children:[e.jsx("h4",{className:"font-semibold",children:"En Progreso"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-500",children:l.inProgress})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow text-center",children:[e.jsx("h4",{className:"font-semibold",children:"Resueltos"}),e.jsx("p",{className:"text-3xl font-bold text-green-500",children:l.resolved})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow h-80",children:[e.jsxs("h4",{className:"font-semibold mb-2 text-center flex items-center justify-center",children:[e.jsx(k,{className:"h-5 w-5 mr-2"}),"Reportes por Tipo"]}),e.jsx(p,{width:"100%",height:"100%",children:e.jsxs(R,{children:[e.jsx(C,{data:l.typeData,dataKey:"value",nameKey:"name",cx:"50%",cy:"45%",outerRadius:80,fill:"#8884d8",label:!0,children:l.typeData.map((s,r)=>e.jsx(D,{fill:K[r%K.length]},`cell-${r}`))}),e.jsx(b,{}),e.jsx(y,{})]})})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow h-80",children:[e.jsxs("h4",{className:"font-semibold mb-2 text-center flex items-center justify-center",children:[e.jsx(k,{className:"h-5 w-5 mr-2"}),"Reportes por Estado"]}),e.jsx(p,{width:"100%",height:"100%",children:e.jsxs(R,{children:[e.jsx(C,{data:l.statusData,dataKey:"value",nameKey:"name",cx:"50%",cy:"45%",outerRadius:80,fill:"#82ca9d",label:!0,children:l.statusData.map((s,r)=>e.jsx(D,{fill:O[r%O.length]},`cell-${r}`))}),e.jsx(b,{}),e.jsx(y,{})]})})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow h-80 lg:col-span-2",children:[e.jsxs("h4",{className:"font-semibold mb-2 text-center flex items-center justify-center",children:[e.jsx(Q,{className:"h-5 w-5 mr-2"}),"Incidencia por Docente"]}),e.jsx(p,{width:"100%",height:"90%",children:e.jsxs(S,{data:l.teacherData,layout:"vertical",margin:{top:5,right:30,left:50,bottom:5},children:[e.jsx(F,{strokeDasharray:"3 3"}),e.jsx(T,{type:"number"}),e.jsx(I,{type:"category",dataKey:"name",width:120}),e.jsx(b,{}),e.jsx(E,{dataKey:"value",fill:"#8884d8"})]})})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow h-80 lg:col-span-2",children:[e.jsxs("h4",{className:"font-semibold mb-2 text-center flex items-center justify-center",children:[e.jsx(W,{className:"h-5 w-5 mr-2"}),"Incidencia por Grado"]}),e.jsx(p,{width:"100%",height:"90%",children:e.jsxs(S,{data:l.gradeData,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(F,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"name"}),e.jsx(I,{}),e.jsx(b,{}),e.jsx(y,{}),e.jsx(E,{dataKey:"value",fill:"#82ca9d"})]})})]})]})]})};export{de as default};
